{
  "id": "/{{service.name}}/dcos-launcher",
  "maintainer": "support@galacticfog.com",
  "container": {
    "type": "DOCKER",
    "docker": {
      "image": "galacticfog/gestalt-dcos:{{service.framework-version}}",
      "network": "BRIDGE",
      "portMappings": [
        {"containerPort": 9000, "name": "dashboard"}
      ],
      "forcePullImage": true
    }
  },
  "env": {
    "JVM_OPTS": "-Xmx384m",
    "GESTALT_FRAMEWORK_VERSION": "{{service.framework-version}}",

    "MARATHON_APP_GROUP": "{{service.name}}",
    "MARATHON_URL": "{{service.marathon-url}} ",
    {{#service.tld}}    "MARATHON_TLD":    "{{service.tld}}",   {{/service.tld}} 
    {{#service.lb-url}} "MARATHON_LB_URL": "{{service.lb-url}}, {{/service.lb-url}} 

    "DATABASE_USERNAME":  "{{database.username}}",
    "DATABASE_PASSWORD":  "{{database.password}}",
    "DATABASE_PROVISION": "{{database.provision}}",
    {{#database.hostname}}           "DATABASE_HOSTNAME":           "{{database.hostname}}",           {{/database.hostname}}
    {{#database.num-secondaries}}    "DATABASE_NUM_SECONDARIES":    "{{database.num-secondaries}}",    {{/database.num-secondaries}}
    {{#database.port}}               "DATABASE_PORT":               "{{database.port}}",               {{/database.port}}
    {{#database.prefix}}             "DATABASE_PREFIX":             "{{database.prefix}}",             {{/database.prefix}}
    {{#database.provisioned-cpu}}    "DATABASE_PROVISIONED_CPU":    "{{database.provisioned-cpu}}",    {{/database.provisioned-cpu}}
    {{#database.provisioned-memory}} "DATABASE_PROVISIONED_MEMORY": "{{database.provisioned-memory}}", {{/database.provisioned-memory}}
    {{#database.provisioned-size}}   "DATABASE_PROVISIONED_SIZE":   "{{database.provisioned-size}}",   {{/database.provisioned-size}}

    "SECURITY_USERNAME": "{{security.admin-username}}",
    "SECURITY_PASSWORD": "{{security.admin-password}}",

    "LASER_ENABLE_JS_RUNTIME":     "{{laser.enable-js-runtime}}",
    "LASER_ENABLE_JVM_RUNTIME":    "{{laser.enable-jvm-runtime}}",
    "LASER_ENABLE_DOTNET_RUNTIME": "{{laser.enable-dotnet-runtime}}",
    "LASER_ENABLE_RUBY_RUNTIME":   "{{laser.enable-ruby-runtime}}",
    "LASER_ENABLE_PYTHON_RUNTIME": "{{laser.enable-python-runtime}}",
    "LASER_ENABLE_GOLANG_RUNTIME": "{{laser.enable-golang-runtime}}",
    "LASER_MAX_PORT_RANGE": "{{laser.max-port-range}}",
    "LASER_MIN_PORT_RANGE": "{{laser.min-port-range}}",
    "LASER_SCALE_DOWN_TIMEOUT": "{{laser.scale-down-timeout}}",
    "LASER_MIN_COOL_EXECUTORS": "{{laser.min-cool-executors}}"
  },
  "cmd": "./bin/gestalt-dcos -Dmeta.company-name=\"{{meta.company-name}}\" {{#service.debug-logging}}-Dlogger.resource=debug-logging.xml{{/service.debug-logging}} 
  "cpus": 0.25,
  "mem": 512,
  "instances": 1,
  "labels": {
    "DCOS_SERVICE_NAME": "{{service.name}}",
    "DCOS_SERVICE_SCHEME": "http",
    "DCOS_SERVICE_PORT_INDEX": "0"
  },
  {{#service.role}}
     "acceptedResourceRoles": [
       "{{service.role}}"
     ],
  {{/service.role}}
  "healthChecks": [{
    "protocol": "HTTP",
    "path": "/_gfhealth",
    "portIndex": 0,
    "gracePeriodSeconds": 60,
    "intervalSeconds": 30,
    "maxConsecutiveFailures": 0
  }]
}
